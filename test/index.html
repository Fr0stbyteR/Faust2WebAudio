<html>
    <head>
        <script src="../dist/index.min.js"></script>
        <script>
            audioCtx = new AudioContext();
            const faust = new Faust2WebAudio.Faust();
            window.faust = faust;
            faust.ready
            .then(() => {
                code = `
import("stdfaust.lib");
process = ba.pulsen(1, 10000) : pm.djembe(60, 0.3, 0.4, 1) <: dm.freeverb_demo;`;
                polycode = `
import("stdfaust.lib");
process = ba.pulsen(1, 10000) : pm.djembe(ba.hz2midikey(freq), 0.3, 0.4, 1) * gate * gain with {
    freq = hslider("freq", 440, 40, 8000, 1);
    gain = hslider("gain", 0.5, 0, 1, 0.01);
    gate = button("gate");
};
effect = dm.freeverb_demo;`;
                faust.getNode(polycode, { audioCtx, useWorklet: window.AudioWorklet ? true : false, voices: 4, args: { "-I": "https://faust.grame.fr/tools/editor/libraries/" } })
                .then(node => {
                    window.node = node;
                    node.connect(audioCtx.destination);
                });
                faust.getNode(code, { audioCtx, useWorklet: window.AudioWorklet ? true : false, args: { "-I": "https://faust.grame.fr/tools/editor/libraries/" } })
                .then(node => {
                    window.node1 = node;
                    node.connect(audioCtx.destination);
                });
            })
        </script>
    </head>
    <body>
    </body>
</html>
